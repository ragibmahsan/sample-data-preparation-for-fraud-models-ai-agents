{
  "paragraphs": [
    {
      "text": "%flink.ssql\nDROP TABLE IF EXISTS demo_transactions;\nCREATE TABLE demo_transactions (\n    `event_timestamp` STRING,\n    `label_name` STRING,\n    `event_id` STRING,\n    `entity_type` STRING,\n    `entity_id` STRING,\n    `card_bin` STRING,\n    `billing_latitude` STRING,\n    `billing_longitude` STRING,\n    `billing_country` STRING,\n    `customer_job` STRING,\n    `user_agent` STRING,\n    `product_category` STRING,\n    `order_price` STRING,\n    `payment_currency` STRING,\n    `merchant` STRING,\n    `ip_address` STRING\n) WITH (\n    'connector' = 'kafka',\n    'topic' = 'demo_transactions',\n    'properties.bootstrap.servers' = '<ADD_BOOTSTRAP_SERVERS>',\n    'properties.security.protocol' = 'SASL_SSL',\n    'properties.sasl.mechanism' = 'AWS_MSK_IAM',\n    'properties.sasl.jaas.config' = 'software.amazon.msk.auth.iam.IAMLoginModule required;',\n    'properties.sasl.client.callback.handler.class' = 'software.amazon.msk.auth.iam.IAMClientCallbackHandler',\n    'properties.group.id' = 'IAMGroup',\n    'scan.startup.mode' = 'earliest-offset',\n    'format' = 'json',\n    'json.timestamp-format.standard'= 'ISO-8601'\n);",
      "user": "anonymous",
      "dateUpdated": "2024-08-21T15:01:23+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql",
        "colWidth": 12,
        "editorHide": false,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1724248093882_1682223255",
      "id": "20230801-010840_1940977515",
      "dateCreated": "2024-08-21T13:48:13+0000",
      "dateStarted": "2024-08-21T14:04:43+0000",
      "dateFinished": "2024-08-21T14:04:46+0000",
      "status": "FINISHED",
      "focus": true,
      "$$hashKey": "object:4647"
    },
    {
      "text": "%flink.ssql(type=update)\nSELECT *\nFROM demo_transactions;",
      "user": "anonymous",
      "dateUpdated": "2024-08-21T14:47:29+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sql",
        "fontSize": 9,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "event_timestamp": "string",
                      "label_name": "string",
                      "event_id": "string",
                      "entity_type": "string",
                      "entity_id": "string",
                      "card_bin": "string",
                      "billing_latitude": "string",
                      "billing_longitude": "string",
                      "billing_country": "string",
                      "customer_job": "string",
                      "user_agent": "string",
                      "product_category": "string",
                      "order_price": "string",
                      "payment_currency": "string",
                      "merchant": "string",
                      "ip_address": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "FLINK JOB",
          "tooltip": "View in Flink web UI",
          "group": "flink",
          "values": [
            {
              "jobUrl": "/flinkdashboard/#/job/56c63334c85f991a70eaeb5819f40d71",
              "$$hashKey": "object:4910"
            }
          ],
          "interpreterSettingId": "flink"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1724248093882_680720254",
      "id": "paragraph_1719274916821_1557295300",
      "dateCreated": "2024-08-21T13:48:13+0000",
      "dateStarted": "2024-08-21T14:06:21+0000",
      "dateFinished": "2024-08-21T14:06:39+0000",
      "status": "ABORT",
      "$$hashKey": "object:4648"
    },
    {
      "text": "%flink.ssql\nDROP TABLE IF EXISTS flagged_transactions;\nCREATE TABLE flagged_transactions (\n    `event_timestamp` STRING,\n    `entity_id` STRING,\n    `billing_city` STRING,\n    `billing_state` STRING,\n    `billing_zip` STRING\n) WITH (\n    'connector' = 'kafka',\n    'topic' = 'flagged_transactions',\n    'properties.bootstrap.servers' = '<ADD_BOOTSTRAP_SERVERS>',\n    'properties.security.protocol' = 'SASL_SSL',\n    'properties.sasl.mechanism' = 'AWS_MSK_IAM',\n    'properties.sasl.jaas.config' = 'software.amazon.msk.auth.iam.IAMLoginModule required;',\n    'properties.sasl.client.callback.handler.class' = 'software.amazon.msk.auth.iam.IAMClientCallbackHandler',\n    'properties.group.id' = 'IAMGroup',\n    'scan.startup.mode' = 'earliest-offset',\n    'format' = 'json',\n    'json.timestamp-format.standard'= 'ISO-8601'\n);",
      "user": "anonymous",
      "dateUpdated": "2024-08-21T15:01:46+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql",
        "colWidth": 12,
        "editorHide": false,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1724248093883_1007510459",
      "id": "20230801-010840_877932043",
      "dateCreated": "2024-08-21T13:48:13+0000",
      "dateStarted": "2024-08-21T14:04:55+0000",
      "dateFinished": "2024-08-21T14:04:56+0000",
      "status": "FINISHED",
      "$$hashKey": "object:4649"
    },
    {
      "text": "%flink.ssql(type=update)\nSELECT *\nFROM flagged_transactions;",
      "user": "anonymous",
      "dateUpdated": "2024-08-21T14:06:52+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql",
        "colWidth": 12,
        "editorHide": false,
        "fontSize": 9,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "event_timestamp": "string",
                      "entity_id": "string",
                      "billing_city": "string",
                      "billing_state": "string",
                      "billing_zip": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "FLINK JOB",
          "tooltip": "View in Flink web UI",
          "group": "flink",
          "values": [
            {
              "jobUrl": "/flinkdashboard/#/job/235f0d37a744158ddede3d882db908c9",
              "$$hashKey": "object:5000"
            }
          ],
          "interpreterSettingId": "flink"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1724248093883_1046851196",
      "id": "20230801-010840_1920340350",
      "dateCreated": "2024-08-21T13:48:13+0000",
      "dateStarted": "2024-08-21T14:06:52+0000",
      "dateFinished": "2024-08-21T14:07:11+0000",
      "status": "ABORT",
      "$$hashKey": "object:4650"
    },
    {
      "text": "%flink.ssql\nDROP TABLE IF EXISTS processed_transactions;\nCREATE TABLE processed_transactions (\n    `event_timestamp` STRING,\n    `label_name` STRING,\n    `event_id` STRING,\n    `entity_type` STRING,\n    `entity_id` STRING,\n    `card_bin` STRING,\n    `billing_city` STRING,\n    `billing_state` STRING,\n    `billing_zip` STRING,\n    `billing_latitude` STRING,\n    `billing_longitude` STRING,\n    `billing_country` STRING,\n    `customer_job` STRING,\n    `ip_address` STRING,\n    `user_agent` STRING,\n    `product_category` STRING,\n    `order_price` STRING,\n    `payment_currency` STRING,\n    `merchant` STRING\n) WITH (\n    'connector' = 'kafka',\n    'topic' = 'processed_transactions',\n    'properties.bootstrap.servers' = '<ADD_BOOTSTRAP_SERVERS>',\n    'properties.security.protocol' = 'SASL_SSL',\n    'properties.sasl.mechanism' = 'AWS_MSK_IAM',\n    'properties.sasl.jaas.config' = 'software.amazon.msk.auth.iam.IAMLoginModule required;',\n    'properties.sasl.client.callback.handler.class' = 'software.amazon.msk.auth.iam.IAMClientCallbackHandler',\n    'properties.group.id' = 'IAMGroup',\n    'scan.startup.mode' = 'earliest-offset',\n    'format' = 'json',\n    'json.timestamp-format.standard'= 'ISO-8601'\n);",
      "user": "anonymous",
      "dateUpdated": "2024-08-21T15:01:56+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql",
        "colWidth": 12,
        "editorHide": false,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1724248093883_1503385989",
      "id": "20230801-010840_2121882945",
      "dateCreated": "2024-08-21T13:48:13+0000",
      "dateStarted": "2024-08-21T14:05:04+0000",
      "dateFinished": "2024-08-21T14:05:05+0000",
      "status": "FINISHED",
      "$$hashKey": "object:4651"
    },
    {
      "text": "%flink.ssql(type=update)\nINSERT INTO  processed_transactions\nSELECT \n    dt.event_timestamp,\n    dt.label_name,\n    dt.event_id,\n    dt.entity_type,\n    dt.entity_id,\n    dt.card_bin,\n    ft.billing_city,\n    ft.billing_state,\n    ft.billing_zip,\n    dt.billing_latitude,\n    dt.billing_longitude,\n    dt.billing_country,\n    dt.customer_job,\n    dt.ip_address,\n    dt.user_agent,\n    dt.product_category,\n    dt.order_price,\n    dt.payment_currency,\n    dt.merchant\nFROM\n    demo_transactions dt,\n    flagged_transactions ft \nWHERE\n    dt.entity_id = ft.entity_id \nAND\n     to_timestamp(replace(replace(dt.event_timestamp, 'T', ' '), 'Z', ' '),'yyyy-MM-dd HH:mm:ss.SSS') >=  to_timestamp(replace(replace(ft.event_timestamp, 'T', ' '), 'Z', ' '),'yyyy-MM-dd HH:mm:ss.SSS');",
      "user": "anonymous",
      "dateUpdated": "2024-08-21T14:07:40+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql",
        "colWidth": 12,
        "editorHide": false,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "FLINK JOB",
          "tooltip": "View in Flink web UI",
          "group": "flink",
          "values": [
            {
              "jobUrl": "/flinkdashboard/#/job/faf1db4c2978e1bd20adb41485aaf6a1",
              "$$hashKey": "object:5090"
            }
          ],
          "interpreterSettingId": "flink"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1724248093883_1760335850",
      "id": "20230801-010840_1799880947",
      "dateCreated": "2024-08-21T13:48:13+0000",
      "dateStarted": "2024-08-21T14:07:40+0000",
      "dateFinished": "2024-08-21T14:08:22+0000",
      "status": "ERROR",
      "$$hashKey": "object:4652"
    },
    {
      "text": "%flink.ssql(type=update)\nSELECT * \nFROM processed_transactions;",
      "user": "anonymous",
      "dateUpdated": "2024-08-21T14:07:55+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql",
        "colWidth": 12,
        "editorHide": false,
        "fontSize": 9,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "event_timestamp": "string",
                      "label_name": "string",
                      "event_id": "string",
                      "entity_type": "string",
                      "entity_id": "string",
                      "card_bin": "string",
                      "billing_city": "string",
                      "billing_state": "string",
                      "billing_zip": "string",
                      "billing_latitude": "string",
                      "billing_longitude": "string",
                      "billing_country": "string",
                      "customer_job": "string",
                      "ip_address": "string",
                      "user_agent": "string",
                      "product_category": "string",
                      "order_price": "string",
                      "payment_currency": "string",
                      "merchant": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "FLINK JOB",
          "tooltip": "View in Flink web UI",
          "group": "flink",
          "values": [
            {
              "jobUrl": "/flinkdashboard/#/job/7565675ea18991e1e13e59f202d1dd3c",
              "$$hashKey": "object:5138"
            }
          ],
          "interpreterSettingId": "flink"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1724248093883_1928049051",
      "id": "20230801-010840_695668997",
      "dateCreated": "2024-08-21T13:48:13+0000",
      "dateStarted": "2024-08-21T14:07:56+0000",
      "dateFinished": "2024-08-21T14:08:21+0000",
      "status": "ERROR",
      "$$hashKey": "object:4653"
    },
    {
      "text": "%flink.ssql\n",
      "user": "anonymous",
      "dateUpdated": "2024-08-21T13:55:11+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1724248511181_1108184186",
      "id": "paragraph_1724248511181_1108184186",
      "dateCreated": "2024-08-21T13:55:11+0000",
      "status": "READY",
      "$$hashKey": "object:4654"
    }
  ],
  "name": "WSFlinkNotebook",
  "id": "2K5EEDTED",
  "defaultInterpreterGroup": "flink",
  "version": "0.10.1",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "flink-shared_process": [
      {
        "name": "duration",
        "object": "15 seconds",
        "noteId": "2K5EEDTED",
        "paragraphId": "20230801-010840_1799880947"
      }
    ]
  },
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {},
  "path": "/WSFlinkNotebook"
}