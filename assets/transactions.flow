{"metadata": {"version": 1, "disable_limits": false, "instance_type": "ml.m5.4xlarge", "disable_validation": true}, "parameters": [], "nodes": [{"node_id": "83b6fd58-5bf4-42aa-aeb9-1d4c7e60ab41", "type": "SOURCE", "operator": "sagemaker.s3_source_0.1", "parameters": {"dataset_definition": {"datasetSourceType": "S3", "name": "demo_transactions_100k.csv", "description": null, "s3ExecutionContext": {"s3Uri": "s3://sagemaker-us-east-1-851725457246/demo_transactions_100k.csv", "s3ContentType": "csv", "s3HasHeader": true, "s3FieldDelimiter": ",", "s3DirIncludesNested": false, "s3AddsFilenameColumn": false, "s3RoleArn": null, "s3CsvEncodingType": "UTF_8", "s3SkipLines": 0, "s3MultiLine": false, "s3DataType": "S3Prefix", "s3ManifestPlain": {"s3Uris": null}}, "canvasDatasetMetadata": null}}, "inputs": [], "outputs": [{"name": "default", "sampling": {"sampling_method": "sample_by_count", "sample_size": 5000}}]}, {"node_id": "10c29271-6655-4ac8-9aaf-1f7730495f8a", "type": "TRANSFORM", "operator": "sagemaker.spark.infer_and_cast_type_0.1", "parameters": {}, "trained_parameters": {"schema": {"event_timestamp": "datetime", "label_name": "datetime", "event_id": "string", "entity_type": "string", "entity_id": "string", "card_bin": "long", "customer_name": "string", "billing_street": "string", "billing_city": "string", "billing_state": "string", "billing_zip": "long", "billing_latitude": "float", "billing_longitude": "float", "billing_country": "string", "customer_job": "string", "ip_address": "string", "customer_email": "string", "billing_phone": "string", "user_agent": "string", "product_category": "string", "order_price": "float", "payment_currency": "string", "merchant": "string", "is_fraud": "string"}}, "inputs": [{"name": "default", "node_id": "83b6fd58-5bf4-42aa-aeb9-1d4c7e60ab41", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "3664a17f-7954-4143-8923-7fb98ae09e62", "type": "VISUALIZATION", "operator": "sagemaker.visualizations.data_insights_report_0.1", "parameters": {"name": "transactions_quality_insights", "insights_report_parameters": {"target_column": "is_fraud", "problem_type": "Classification"}, "full_data": "true", "instance_type": "ml.m5.4xlarge", "number_of_instances": 2, "output_config": {"output_path": "s3://sagemaker-us-east-1-851725457246/Canvas/default-20240416t090470/DataPrep/", "output_content_type": "JSON"}}, "trained_parameters": {"job_name": "canvas-data-prep-data-wrangler-dqi-job1725218477516"}, "inputs": [{"name": "df", "node_id": "10c29271-6655-4ac8-9aaf-1f7730495f8a", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "00a2f521-fe25-4955-b632-4ab8cda54528", "type": "TRANSFORM", "operator": "sagemaker.spark.manage_columns_0.1", "parameters": {"operator": "Drop column", "drop_column_parameters": {"column_to_drop": ["label_name", "entity_type", "customer_name", "billing_street", "billing_country", "billing_phone", "customer_job", "customer_email", "event_id", "ip_address"]}}, "inputs": [{"name": "df", "node_id": "10c29271-6655-4ac8-9aaf-1f7730495f8a", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "66f25c7d-30e6-4f95-ac71-7a771d5a6577", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_code_0.1", "parameters": {"operator": "Python (Pandas)", "pandas_parameters": {"code": "# Table is available as variable `df`\ncat_cols = df.dtypes[df.dtypes == object].index\ndf[cat_cols] = df[cat_cols].apply(lambda x: x.str.lower())"}, "pyspark_parameters": {}, "name": "convert_to_lowercase"}, "inputs": [{"name": "df", "node_id": "00a2f521-fe25-4955-b632-4ab8cda54528", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "d1ae292a-dc70-4282-8329-82c2b69181a6", "type": "TRANSFORM", "operator": "sagemaker.spark.format_string_0.1", "parameters": {"operator": "Remove symbols", "remove_symbols_parameters": {"input_column": ["entity_id"], "symbols": "-."}, "lower_case_parameters": {}}, "inputs": [{"name": "df", "node_id": "66f25c7d-30e6-4f95-ac71-7a771d5a6577", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "40be72f8-dbbc-42bf-b2fd-3790277dc46a", "type": "TRANSFORM", "operator": "sagemaker.spark.featurize_date_time_0.1", "parameters": {"operator": "Extract columns", "extract_columns_parameters": {"input_column": ["event_timestamp"], "output_mode": "Ordinal", "output_format": "Columns", "infer_datetime_format": false, "date_time_format": "", "year": true, "month": true, "day": true, "hour": false, "minute": false, "second": false, "week_of_year": false, "day_of_year": false, "quarter": false, "use_one_indexing": false}}, "inputs": [{"name": "df", "node_id": "d1ae292a-dc70-4282-8329-82c2b69181a6", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "8a1db676-abd8-4f86-94ba-3e98fa256b06", "type": "TRANSFORM", "operator": "sagemaker.spark.manage_columns_0.1", "parameters": {"operator": "Drop column", "drop_column_parameters": {"column_to_drop": ["event_timestamp"]}}, "inputs": [{"name": "df", "node_id": "40be72f8-dbbc-42bf-b2fd-3790277dc46a", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "6f919800-d362-4a94-aaf1-487620ebc3a2", "type": "TRANSFORM", "operator": "sagemaker.spark.encode_categorical_0.1", "parameters": {"operator": "Ordinal encode", "ordinal_encode_parameters": {"input_column": ["billing_city", "billing_state", "merchant", "payment_currency", "product_category", "user_agent"], "invalid_handling_strategy": "Replace with NaN"}}, "inputs": [{"name": "df", "node_id": "8a1db676-abd8-4f86-94ba-3e98fa256b06", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "13290130-bc13-4760-8b50-6a5719522d9b", "type": "TRANSFORM", "operator": "sagemaker.spark.cast_single_data_type_0.1", "parameters": {"column": "entity_id", "original_data_type": "String", "data_type": "long"}, "inputs": [{"name": "df", "node_id": "6f919800-d362-4a94-aaf1-487620ebc3a2", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "49d02bdd-6f75-4652-b456-501e4c842487", "type": "TRANSFORM", "operator": "sagemaker.spark.encode_categorical_0.1", "parameters": {"operator": "One-hot encode", "one_hot_encode_parameters": {"input_column": ["is_fraud"], "invalid_handling_strategy": "Keep", "drop_last": false, "output_style": "Columns"}, "ordinal_encode_parameters": {"input_column": ["is_fraud"], "invalid_handling_strategy": "Replace with NaN"}}, "inputs": [{"name": "df", "node_id": "13290130-bc13-4760-8b50-6a5719522d9b", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "dce5a95c-7d4c-41a8-a4fe-a6c303cbece7", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_code_0.1", "parameters": {"operator": "Python (Pandas)", "pandas_parameters": {"code": "# Table is available as variable `df`\nimport pandas as pd\ndf['event_time'] = pd.to_datetime('now').timestamp()"}, "pyspark_parameters": {"code": "# Table is available as variable `df`\nimport pandas as pd\ndf['event_time'] = pd.to_datetime('now').timestamp()"}, "name": "add_event_time"}, "inputs": [{"name": "df", "node_id": "49d02bdd-6f75-4652-b456-501e4c842487", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "5e6598c7-c275-4895-8cd0-5308b16d8842", "type": "DESTINATION", "operator": "sagemaker.spark.s3_destination_0.1", "name": "S3: Dataset_20240901_222659", "parameters": {"output_config": {"delimiter": ",", "compression": "none", "dataset_name": "Dataset_20240901_222659", "file_type": "CSV", "file_format_type": "CSV", "output_content_type": "CSV", "file_name": "Dataset_20240901_222659", "output_path": "s3://sagemaker-us-east-1-851725457246/"}}, "inputs": [{"name": "default", "node_id": "dce5a95c-7d4c-41a8-a4fe-a6c303cbece7", "output_name": "default"}], "outputs": [{"name": "default"}]}]}