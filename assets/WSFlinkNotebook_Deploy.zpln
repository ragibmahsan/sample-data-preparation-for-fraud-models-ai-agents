{
  "paragraphs": [
    {
      "text": "%flink.ssql\nDROP TABLE IF EXISTS demo_transactions;\nCREATE TABLE demo_transactions (\n    `event_timestamp` STRING,\n    `label_name` STRING,\n    `event_id` STRING,\n    `entity_type` STRING,\n    `entity_id` STRING,\n    `card_bin` STRING,\n    `billing_latitude` STRING,\n    `billing_longitude` STRING,\n    `billing_country` STRING,\n    `customer_job` STRING,\n    `user_agent` STRING,\n    `product_category` STRING,\n    `order_price` STRING,\n    `payment_currency` STRING,\n    `merchant` STRING,\n    `ip_address` STRING\n) WITH (\n    'connector' = 'kafka',\n    'topic' = 'demo_transactions',\n    'properties.bootstrap.servers' = '<ADD_BOOTSTRAP_SERVERS>',\n    'properties.security.protocol' = 'SASL_SSL',\n    'properties.sasl.mechanism' = 'AWS_MSK_IAM',\n    'properties.sasl.jaas.config' = 'software.amazon.msk.auth.iam.IAMLoginModule required;',\n    'properties.sasl.client.callback.handler.class' = 'software.amazon.msk.auth.iam.IAMClientCallbackHandler',\n    'properties.group.id' = 'IAMGroup',\n    'scan.startup.mode' = 'latest-offset',\n    'format' = 'json',\n    'json.timestamp-format.standard'= 'ISO-8601'\n);",
      "user": "anonymous",
      "dateUpdated": "2024-08-21T15:10:36+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql",
        "colWidth": 12,
        "editorHide": false,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1724252570988_1534639332",
      "id": "20230801-010840_1940977515",
      "dateCreated": "2024-08-21T15:02:50+0000",
      "status": "READY",
      "focus": true,
      "$$hashKey": "object:5338"
    },
    {
      "text": "%flink.ssql\nDROP TABLE IF EXISTS flagged_transactions;\nCREATE TABLE flagged_transactions (\n    `event_timestamp` STRING,\n    `entity_id` STRING,\n    `billing_city` STRING,\n    `billing_state` STRING,\n    `billing_zip` STRING\n) WITH (\n    'connector' = 'kafka',\n    'topic' = 'flagged_transactions',\n    'properties.bootstrap.servers' = '<ADD_BOOTSTRAP_SERVERS>',\n    'properties.security.protocol' = 'SASL_SSL',\n    'properties.sasl.mechanism' = 'AWS_MSK_IAM',\n    'properties.sasl.jaas.config' = 'software.amazon.msk.auth.iam.IAMLoginModule required;',\n    'properties.sasl.client.callback.handler.class' = 'software.amazon.msk.auth.iam.IAMClientCallbackHandler',\n    'properties.group.id' = 'IAMGroup',\n    'scan.startup.mode' = 'latest-offset',\n    'format' = 'json',\n    'json.timestamp-format.standard'= 'ISO-8601'\n);",
      "user": "anonymous",
      "dateUpdated": "2024-08-21T15:10:41+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql",
        "colWidth": 12,
        "editorHide": false,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1724252570988_1721324758",
      "id": "20230801-010840_877932043",
      "dateCreated": "2024-08-21T15:02:50+0000",
      "status": "READY",
      "$$hashKey": "object:5340"
    },
    {
      "text": "%flink.ssql\nDROP TABLE IF EXISTS processed_transactions;\nCREATE TABLE processed_transactions (\n    `event_timestamp` STRING,\n    `label_name` STRING,\n    `event_id` STRING,\n    `entity_type` STRING,\n    `entity_id` STRING,\n    `card_bin` STRING,\n    `billing_city` STRING,\n    `billing_state` STRING,\n    `billing_zip` STRING,\n    `billing_latitude` STRING,\n    `billing_longitude` STRING,\n    `billing_country` STRING,\n    `customer_job` STRING,\n    `ip_address` STRING,\n    `user_agent` STRING,\n    `product_category` STRING,\n    `order_price` STRING,\n    `payment_currency` STRING,\n    `merchant` STRING\n) WITH (\n    'connector' = 'kafka',\n    'topic' = 'processed_transactions',\n    'properties.bootstrap.servers' = '<ADD_BOOTSTRAP_SERVERS>',\n    'properties.security.protocol' = 'SASL_SSL',\n    'properties.sasl.mechanism' = 'AWS_MSK_IAM',\n    'properties.sasl.jaas.config' = 'software.amazon.msk.auth.iam.IAMLoginModule required;',\n    'properties.sasl.client.callback.handler.class' = 'software.amazon.msk.auth.iam.IAMClientCallbackHandler',\n    'properties.group.id' = 'IAMGroup',\n    'scan.startup.mode' = 'latest-offset',\n    'format' = 'json',\n    'json.timestamp-format.standard'= 'ISO-8601'\n);",
      "user": "anonymous",
      "dateUpdated": "2024-08-21T15:10:50+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql",
        "colWidth": 12,
        "editorHide": false,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1724252570988_952620202",
      "id": "20230801-010840_2121882945",
      "dateCreated": "2024-08-21T15:02:50+0000",
      "status": "READY",
      "$$hashKey": "object:5342"
    },
    {
      "text": "%flink.ssql(type=update)\nINSERT INTO  processed_transactions\nSELECT \n    dt.event_timestamp,\n    dt.label_name,\n    dt.event_id,\n    dt.entity_type,\n    dt.entity_id,\n    dt.card_bin,\n    ft.billing_city,\n    ft.billing_state,\n    ft.billing_zip,\n    dt.billing_latitude,\n    dt.billing_longitude,\n    dt.billing_country,\n    dt.customer_job,\n    dt.ip_address,\n    dt.user_agent,\n    dt.product_category,\n    dt.order_price,\n    dt.payment_currency,\n    dt.merchant\nFROM\n    demo_transactions dt,\n    flagged_transactions ft \nWHERE\n    dt.entity_id = ft.entity_id \nAND\n     to_timestamp(replace(replace(dt.event_timestamp, 'T', ' '), 'Z', ' '),'yyyy-MM-dd HH:mm:ss.SSS') >=  to_timestamp(replace(replace(ft.event_timestamp, 'T', ' '), 'Z', ' '),'yyyy-MM-dd HH:mm:ss.SSS');",
      "user": "anonymous",
      "dateUpdated": "2024-08-21T15:02:50+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false
        },
        "editorMode": "ace/mode/sql",
        "colWidth": 12,
        "editorHide": false,
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1724252570988_1834217622",
      "id": "20230801-010840_1799880947",
      "dateCreated": "2024-08-21T15:02:50+0000",
      "status": "READY",
      "$$hashKey": "object:5343"
    }
  ],
  "name": "WSFlinkNotebook_Deploy",
  "id": "2K83D7F4P",
  "defaultInterpreterGroup": "flink",
  "version": "0.10.1",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {},
  "path": "/WSFlinkNotebook_Deploy"
}